;HAND POR INTERRUPCIONES: HAY PIC, 1RO HAB INT HAND, POR ULTIMO DESHAB INT HAND
;NO CONTROLO NI BUSY NI STROBE
HAND EQU 40H; DATOS ESTADO
PIC EQU 20H; EOI IMR IRR ISR INT0 INT1 INT2(HAND)
N_HND EQU 10

ORG 40
IP_HND DW RUT_HND

ORG 1000H
CADENA DB "ABDef"
FIN DB ?

ORG 3000H

SELECCIONADO:MOV DH,0
CMP DL,41H
JS FIN2
CMP DL,5BH
JNS FIN2
MOV DH,1H
FIN2:RET

RUT_HND:PUSH AX
PUSH DX
MOV DL,[BX];QUIERO QUE MODIFIQUE BX, CL
CALL SELECCIONADO
CMP DH,1H
JNZ MINUSCULA
MOV AL,[BX]
OUT HAND,AL;LO IMPRIME EL SOLO
MINUSCULA:INC BX
DEC CL
MOV AL,20H
OUT PIC,AL
POP DX
POP AX
IRET

HAB_HND:PUSH AX
IN AL,HAND+1
OR AL,10000000B
OUT HAND+1,AL
POP AX
RET

DESHAB_HND:PUSH AX
IN AL,HAND+1
AND AL,01111111B
OUT HAND+1,AL
POP AX
RET

CONF_PIC:PUSH AX
MOV AL,11111011B
OUT PIC+1,AL
MOV AL,N_HND
OUT PIC+6,AL
POP AX
RET

ORG 2000H
CLI
CALL CONF_PIC
CALL HAB_HND
MOV BX,OFFSET CADENA
MOV CL,OFFSET FIN - OFFSET CADENA
STI

ESPERAR:CMP CL,0H
JNZ ESPERAR

FIN1:CALL DESHAB_HND
INT 0
END