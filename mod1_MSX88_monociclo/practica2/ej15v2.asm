PIC EQU 20H; EOI IMR IRR ISR INTO(F10) INT1(TIMER) ...
TIMER EQU 10H; CONT COMP
N_F10 EQU 10
N_CLK EQU 20

ORG 40
IP_F10 DW RUT_F10

ORG 80
IP_CLK DW RUT_CLK

ORG 1000H
MSJ DB "INGRESE NUMERO: "
NUM DB ?

ORG 3000H

CONF_CLK:PUSH AX
MOV AL,0
OUT TIMER,AL
MOV AL,1
OUT TIMER+1,AL
POP AX
RET

CONF_PIC:PUSH AX
MOV AL, 11111110B
OUT PIC+1,AL
MOV AL,N_F10
OUT PIC+4,AL
MOV AL,N_CLK
OUT PIC+5,AL
POP AX
RET

LEER_NUM:PUSH BX
PUSH AX
MOV BX, OFFSET MSJ
MOV AL,OFFSET NUM - OFFSET MSJ
INT 7
MOV BX, OFFSET NUM
INT 6
POP AX
POP BX
RET

RUT_F10:PUSH AX
IN AL, PIC+1
AND AL,11111101B
OUT PIC+1,AL;DESENMASCARO INT1(CLK)
MOV AL,20H
OUT PIC,AL
POP AX
IRET

RUT_CLK:PUSH BX
PUSH AX

MOV BX, OFFSET NUM
MOV AL,1
INT 7

DEC NUM
CMP NUM,30H
JZ SALTO

SALTO:MOV AL,0
OUT TIMER,AL
MOV AL,20H
OUT PIC,AL
POP AX
POP BX
IRET

ORG 2000H
CLI
CALL CONF_PIC;ACTIVO SOLO F10, PORQUE EL TIMER ES ACTIVADO POR F10
CALL LEER_NUM
CALL CONF_CLK;DARLES VALORES A CONT Y COMP
STI

ESPERAR: CMP NUM,30H;CL TIENE EL NUEMRO
JNZ ESPERAR

INT 0
END