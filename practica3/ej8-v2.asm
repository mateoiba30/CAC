HAND EQU 40H;DATOS, ESTADO -> ES LA INT2 -> NO NECESITO PULSO NI POLLING
PIC EQU 20H; EOI IMR IRR ISR INT0 INT1 INT2 INT3
N_HND EQU 10

ORG 40
IP_HND DW RUT_HND

ORG 1000H
CARS DB "123";"TENGO 1 CARACTER, MANDO DE A 1
FIN DB ?

ORG 3000H

HAB_INT:IN AL,HAND+1
OR AL,10000000B;ACTIVO INTERRUPCIONES
OUT HAND+1,AL
RET

DESHAB_INT:IN AL,HAND+1
AND AL,011111111B;DESACTIVO INTERRUPCIONES
OUT HAND+1,AL
RET

CONF_PIC:PUSH AX
MOV AL,11111011B
OUT PIC+1,AL;IMR
MOV AL,N_HND
OUT PIC+6,AL
POP AX
RET

RUT_HND:MOV AL,[BX]
OUT HAND,AL;MANDO A IMPRIMIR
INC BX
DEC CL
MOV AL,20H;FIN INT
OUT PIC,AL
IRET

ORG 2000H
CLI
MOV BX, OFFSET CARS
MOV CL,OFFSET FIN - OFFSET CARS
CALL HAB_INT
CALL CONF_PIC
STI

ESPERAR:CMP CL,1
JNS ESPERAR

CALL DESHAB_INT

HLT
END