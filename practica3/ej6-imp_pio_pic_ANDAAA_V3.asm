PIO EQU 30H
PIC EQU 20H
N_F10 EQU 10

ORG 40
IP_F10 DW RUT_F10

ORG 1000H
NUMS DB "?????"
FIN DB ?

ORG 3000H

PULSO:PUSH AX
IN AL, PIO
OR AL, 02H;activa strobe
OUT PIO, AL
IN AL, PIO;DESACTIVA STROBE
AND AL, 0FDH
OUT PIO, AL
POP AX
RET

CERRAR_IMP:IN AL,PIO
AND AL,0FDH
OUT PIO, AL
RET

RUT_F10:PUSH AX
MOV BX, OFFSET NUMS-1
MOV CL,OFFSET FIN - OFFSET NUMS
LAZO: INC BX
POLL: IN AL, PIO; espero a que no est√© BUSY la impresora
AND AL, 1
JNZ POLL
MOV AL, [BX]
OUT PIO+1, AL;mando caracter a PB
CALL PULSO;imprimo
DEC CL
JNZ LAZO;repito 5 veces

MOV AL,PIC
OUT PIC,AL;le indico al pic que termine la int del f10
POP AX
IRET

CONF_PIC:MOV AL, 0FEH
OUT PIC+1, AL
MOV AL, N_F10
OUT PIC+4,AL

CONF_IMP:MOV AL, 0FDH 
OUT PIO+2, AL 
MOV AL, 0 
OUT PIO+3, AL
IN AL, PIO 
AND AL, 0FDH
OUT PIO, AL
RET

LEER_CARACTERES:PUSH BX
PUSH DX

MOV CL,OFFSET FIN - OFFSET NUMS
MOV DL,0
MOV BX, OFFSET NUMS
REP:INT 6
INC BX
INC DL
CMP DL,CL
JNZ REP

POP DX
POP BX
RET

ORG 2000H

CALL LEER_CARACTERES
CLI
CALL CONF_IMP
CALL CONF_PIC
STI

ESPERAR:CMP CL,0H
JZ FIN2
JMP ESPERAR

FIN2:CALL CERRAR_IMP
INT 0
END